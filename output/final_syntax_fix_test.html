<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>最终JavaScript语法修复验证</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script>
console.log('==liuq debug== 开始加载Chart.js');
(function(){
  var cdnUrls = [
    'assets/chart.umd.min.js',
    'https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js',
    'https://unpkg.com/chart.js@4.4.1/dist/chart.umd.min.js',
    'https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js'
  ];
  var currentIndex = 0;
  
  function loadChart() {
    if (currentIndex >= cdnUrls.length) {
      console.error('==liuq debug== 所有Chart.js CDN都加载失败');
      return;
    }
    
    var url = cdnUrls[currentIndex];
    console.log('==liuq debug== 尝试加载Chart.js:', url);
    
    var script = document.createElement('script');
    script.src = url;
    script.onload = function() {
      console.log('==liuq debug== Chart.js加载成功:', url);
      console.log('==liuq debug== Chart对象检查:', typeof Chart !== 'undefined' ? 'OK' : 'FAILED');
    };
    script.onerror = function() {
      console.warn('==liuq debug== Chart.js加载失败:', url);
      currentIndex++;
      setTimeout(loadChart, 100);
    };
    
    document.head.appendChild(script);
  }
  
  loadChart();
})();
</script>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background-color: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .chart-container { margin: 20px 0; height: 360px; }
        .status { padding: 10px; margin: 10px 0; border-radius: 5px; }
        .success { background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
    </style>
</head>
<body>
    <div class="container">
        <h1>最终JavaScript语法修复验证</h1>
        <div id="status" class="status">正在检查JavaScript语法...</div>
        <div class="chart-container">
            <canvas id="test_chart" style="width:100%;height:100%;display:block;"></canvas>
        </div>
    </div>

    <script>
// 使用修复后的图表渲染脚本
(function() {
  function renderChart() {
    if (typeof Chart === 'undefined') {
      console.warn('==liuq debug== Chart.js 未加载，等待中... test_field');
      setTimeout(renderChart, 200);
      return;
    }

    console.log('==liuq debug== 开始渲染图表: test_field');
    
    // 更新状态
    document.getElementById('status').innerHTML = '✅ JavaScript语法正确，Chart.js已加载，开始渲染图表...';
    document.getElementById('status').className = 'status success';

    // 折线图
    var ctx = document.getElementById('test_chart');
    if (ctx) {
      var c = ctx.getContext('2d');
      new Chart(c, {
        type: 'line',
        data: {
          labels: [1, 2, 3],
          datasets: [
            {
              label: '测试机',
              data: [0.85, 0.87, 0.82],
              borderColor: '#e91e63',
              backgroundColor: 'rgba(233,30,99,0.15)',
              tension: 0.2,
              pointRadius: 2
            },
            {
              label: '对比机',
              data: [0.83, 0.89, 0.8],
              borderColor: '#3f51b5',
              backgroundColor: 'rgba(63,81,181,0.15)',
              tension: 0.2,
              pointRadius: 2
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            title: {
              display: true,
              text: "test_field 趋势对比"
            },
            legend: {
              display: true,
              position: 'top'
            }
          },
          scales: {
            x: {
              display: true,
              title: {
                display: true,
                text: '序列号'
              }
            },
            y: {
              display: true,
              title: {
                display: true,
                text: '数值'
              }
            }
          }
        }
      });
      
      console.log('==liuq debug== 图表渲染完成');
      document.getElementById('status').innerHTML = '✅ JavaScript语法修复成功！Chart.js正常工作，图表渲染完成。';
    }
  }
  
  // 启动图表渲染
  renderChart();
})();

// 检查JavaScript语法错误
window.addEventListener('error', function(e) {
  console.error('==liuq debug== JavaScript错误:', e.message, '在', e.filename, '第', e.lineno, '行');
  document.getElementById('status').innerHTML = '❌ JavaScript语法错误: ' + e.message;
  document.getElementById('status').className = 'status error';
});
    </script>
</body>
</html>
