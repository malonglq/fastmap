ğŸ¯ æ‹–æ‹½åŠŸèƒ½æ ¸å¿ƒæ¶æ„æ€»ç»“
ğŸ“‹ ä¸»è¦ä¾èµ–æ–‡ä»¶å’Œå…³é”®å‡½æ•°
1. utils/pywin_drop.py - ä¸»è¦COMæ‹–æ‹½å®ç°
å…³é”®å‡½æ•°ï¼š

install_pywin_drop(hwnd, on_files) - æ³¨å†ŒCOMæ‹–æ‹½æ¥å£
_DropTarget.Drop() - å¤„ç†æ‹–æ‹½äº‹ä»¶ï¼Œè§£ææ–‡ä»¶
_DropTarget._extract_cf_hdrop() - è§£ææ ‡å‡†æ–‡ä»¶æ‹–æ‹½
_DropTarget._extract_virtual_files() - å¤„ç†è™šæ‹Ÿæ–‡ä»¶æ‹–æ‹½
2. utils/win_drop.py - WM_DROPFILESå¤‡ç”¨æœºåˆ¶
å…³é”®å‡½æ•°ï¼š

install_win_drop(hwnd, on_files) - æ³¨å†ŒWindowsåŸç”Ÿæ‹–æ‹½
_WinDropFilter.nativeEventFilter() - å¤„ç†WM_DROPFILESæ¶ˆæ¯
3. gui/main_window.py - Qtæ‹–æ‹½ç³»ç»Ÿå’Œäº‹ä»¶å¤„ç†
å…³é”®å‡½æ•°ï¼š

showEvent() - çª—å£æ˜¾ç¤ºæ—¶æ³¨å†Œpywin_drop
dragEnterEvent() - Qtæ‹–æ‹½è¿›å…¥äº‹ä»¶
dropEvent() - Qtæ‹–æ‹½é‡Šæ”¾äº‹ä»¶
eventFilter() - å…¨å±€äº‹ä»¶è¿‡æ»¤å™¨
_on_native_files() - ç»Ÿä¸€æ–‡ä»¶å¤„ç†å›è°ƒ
setup_drag_and_drop() - åˆå§‹åŒ–æ‹–æ‹½ç³»ç»Ÿ
_install_all_drop_handlers() - é€’å½’å®‰è£…æ‹–æ‹½å¤„ç†å™¨
ğŸ§¹ åˆ å‡çŠ¶æ€ç¡®è®¤
âœ… å·²åˆ é™¤çš„æ— æ•ˆç»„ä»¶
utils/ole_drop.py - å®Œå…¨åˆ é™¤ï¼Œç¡®è®¤æ— æ•ˆ
ç›¸å…³æ–¹æ³•ï¼š
_install_ole_drop() - å·²åˆ é™¤
_show_ole_fallback_window() - å·²åˆ é™¤
closeEventä¸­çš„oleæ¸…ç†ä»£ç  - å·²åˆ é™¤
âœ… ä¿ç•™çš„å·¥ä½œç»„ä»¶
utils/pywin_drop.py - ä¸»è¦æ‹–æ‹½å®ç°ï¼Œå·²ä¿®å¤
utils/win_drop.py - å¤‡ç”¨æœºåˆ¶ï¼Œæ­£å¸¸å·¥ä½œ
Qtæ‹–æ‹½ç³»ç»Ÿ - äº‹ä»¶å¤„ç†ï¼Œ100+ç»„ä»¶å¯ç”¨
ğŸ¯ å·¥ä½œæµç¨‹
åˆå§‹åŒ–é˜¶æ®µï¼šsetup_drag_and_drop() â†’ _install_all_drop_handlers()
çª—å£æ˜¾ç¤ºï¼šshowEvent() â†’ install_pywin_drop()
æ‹–æ‹½äº‹ä»¶ï¼šCOMæ¥å£ â†’ _DropTarget.Drop() â†’ _on_native_files()
å¤‡ç”¨æœºåˆ¶ï¼šWM_DROPFILES â†’ nativeEventFilter() â†’ _on_native_files()
Qtå¤„ç†ï¼šdragEnterEvent() / dropEvent() â†’ _on_native_files()